{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "semanticCommits": "enabled",
  "dependencyDashboard": true,
  "prHourlyLimit": 0,
  "branchConcurrentLimit": 0,
  "prConcurrentLimit": 30,
  "stabilityDays": 30,
  "suppressNotifications": ["prIgnoreNotification"],
  //  "ignorePaths": ["kube/something/kube-system/multus/**"],
  "rebaseWhen": "conflicted",
  extends: [
    "regexManagers:dockerfileVersions",
  ],

  "flux": {
    "fileMatch": [".+\\.yaml$"]
  },
  "helm-values": {
    "fileMatch": [".+\\.yaml$"]
  },
  "kubernetes": {
    "fileMatch": [".+\\.yaml$"]
  },
  "nix": {
    "enabled": true
  },

  // "schedule": ["every sunday"],
  // "pre-commit": {
  //   "enabled": true
  // },
  // "kubernetes": {
  //   "fileMatch": [
  //     "cluster/.+\\.ya?ml$",
  //     "provision/ansible/.+\\.ya?ml.j2$"
  //   ]
  // },
  "regexManagers": [
    {
      "description": "Docker image and tag classic helm values declaration",
      "fileMatch": [".+\\.yaml$"],
      "matchStrings": [
        "image:\\s+repository: (?<depName>.+?)\\s+tag: (?<currentValue>.+?)\\s"
      ],
      datasourceTemplate: "docker",
      versioningTemplate: "docker"
    }
  ],
  //   {
  //     "description": "Process CRD dependencies",
  //     "fileMatch": ["cluster/crds/.+\\.ya?ml$"],
  //     "matchStrings": [
  //       // GitRepository and Flux Kustomization where 'Git release/tag' matches 'Helm' version
  //       "registryUrl=(?<registryUrl>\\S+) chart=(?<depName>\\S+)\n.*?(?<currentValue>[^-\\s]*)\n",
  //       // Kustomization where 'GitHub release artifact URL' matches 'Docker image' version
  //       "datasource=(?<datasource>\\S+) image=(?<depName>\\S+)\n.*?-\\s(.*?)\/(?<currentValue>[^/]+)\/[^/]+\n"
  //     ],
  //     "datasourceTemplate": "{{#if datasource}}{{{datasource}}}{{else}}helm{{/if}}"
  //   },
  //   {
  //     "description": "Process various other dependencies",
  //     "fileMatch": [
  //       "provision/ansible/.+\\.ya?ml$",
  //       "cluster/.+\\.ya?ml$"
  //     ],
  //     "matchStrings": [
  //       "datasource=(?<datasource>\\S+) depName=(?<depName>\\S+)( versioning=(?<versioning>\\S+))?\n.*?\"(?<currentValue>.*)\"\n"
  //     ],
  //     "datasourceTemplate": "{{#if datasource}}{{{datasource}}}{{else}}github-releases{{/if}}",
  //     "versioningTemplate": "{{#if versioning}}{{{versioning}}}{{else}}semver{{/if}}"
  //   }
  // ],
  "packageRules": [
    {
      matchPackagePatterns: ["mailu"],
      groupName: "mailu"
    },
    {
      matchPackagePatterns: ["intel-gpu"],
      groupName: "intel-gpu"
    },
    {
      "matchUpdateTypes": ["minor", "patch", "pin", "digest"],
      "automerge": true
    },
    //    {
    //      matchDatasources: ["docker"],
    //      matchPackagePrefixes: ["n0rad/"],
    //      versioning: "regex:^(?<major>\\d+)(\\.(?<minor>\\d+))?(\\.(?<patch>\\d+))?(-(?<build>.*))?$",
    //    },
    //    {
    //      matchDatasources: ["docker"],
    //      matchPackageNames: ["archlinux"],
    //      versioning: "regex:^(?<compatibility>.*)-(?<major>\\d+)\\.(?<minor>\\d+)\\.(?<patch>\\d+)$",
    //    },
    //    {
    //      matchDatasources: ["docker"],
    //      matchPackageNames: ["debian"],
    //      versioning: "regex:^(?<compatibility>.*)-(?<minor>\\d+)$",
    //    }
  ],
  "platformAutomerge": true
}


